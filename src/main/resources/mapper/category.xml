<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="category">
	<select id="getList" resultType="ray.data.CategoryVo">
		SELECT
			a.seq
			, a.type_code AS typeCode
			, a.title
			, a.description
			, (SELECT COUNT(*) FROM ch_board WHERE category_seq = a.seq) AS boardCount
		FROM ch_category a
		WHERE 1=1
		ORDER BY a.order_no ASC
	</select>

	<select id="getVo" parameterType="Integer" resultType="ray.data.CategoryVo">
		SELECT
			a.seq
			, a.type_code AS typeCode
			, a.title
			, a.description
			, (SELECT count(*) FROM ch_board WHERE category_seq=a.seq) AS boardCount
		FROM ch_category a
		WHERE seq = #{seq}
	</select>

	<insert id="insertVo" parameterType="ray.data.param.CategoryParamVo">
		INSERT INTO ch_category (
			member_seq
			, type_code
			, title
			, description
			, reg_date
		) VALUES (
			#{memberSeq}
			, #{typeCode}
			, #{title}
			, #{description}
			, NOW()
		)
	</insert>

	<update id="updateVo" parameterType="ray.data.param.CategoryParamVo">
		UPDATE ch_category SET
			type_code=#{typeCode}
			, title=#{title}
			, description=#{description}
			, mod_date=NOW()
		WHERE seq = #{seq}
		AND member_seq = #{memberSeq}
	</update>

	<update id="updateOrderNo" parameterType="ray.data.param.CategoryParamVo">
		UPDATE ch_category SET
			order_no=#{orderNo}
			, mod_date=NOW()
		WHERE seq = #{seq}
		AND member_seq = #{memberSeq}
	</update>

	<delete id="deleteVo" parameterType="Integer">
		DELETE FROM ch_category WHERE seq = #{value}
	</delete>
</mapper>
